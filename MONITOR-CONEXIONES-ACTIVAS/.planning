ğŸ—“ï¸ Plan de proyecto: Monitor de conexiones activas (Bash)
ğŸ§­ Objetivo general
Construir un script Bash que capture las conexiones activas del sistema, guarde los datos en CSV, mantenga una rotaciÃ³n de snapshots y detecte actividad sospechosa (IPs con muchas conexiones).
ğŸ“… Semana 1 â€” Captura y registro bÃ¡sico
DÃ­a 1 â€“ FamiliarizaciÃ³n con herramientas
ğŸ¯ Objetivo: entender la materia prima.
Ejecuta manualmente ss -tunaop y analiza su salida.
Identifica quÃ© campos te sirven: protocolo, estado, IP origen/destino, puertos, proceso.
Guarda un ejemplo de salida en un archivo de texto (ss_output.txt) para practicar parsing.
ğŸ’¡ Tarea: documenta en un mini .md o bloc de notas quÃ© significan los campos que usarÃ¡s.
DÃ­a 2 â€“ ExtracciÃ³n de datos
ğŸ¯ Objetivo: obtener solo las lÃ­neas relevantes y filtrarlas correctamente.
Usa grep, awk, cut para aislar columnas.
Extrae las IPs origen y destino de la salida de ss.
Haz que la salida se vea limpia, tipo:
proto src_ip src_port dst_ip dst_port state pid_prog
ğŸ’¡ Tip: hazlo con un solo comando, sin loops todavÃ­a.
DÃ­a 3 â€“ Generar CSV
ğŸ¯ Objetivo: transformar los datos a CSV.
AÃ±ade una cabecera estÃ¡tica (timestamp, proto, src_ip, â€¦).
Redirige la salida a un archivo conns-YYYYMMDD_HHMMSS.csv.
Comprueba que el CSV se abre correctamente en LibreOffice o VSCode.
ğŸ’¡ Tarea: aÃ±adir un timestamp al principio del script (date "+%Y-%m-%d %H:%M:%S").
DÃ­a 4 â€“ Automatizar snapshots
ğŸ¯ Objetivo: permitir ejecuciones repetidas sin sobrescribir archivos.
Usa una variable SNAP_TS=$(date +%Y%m%d_%H%M%S) para nombrar ficheros.
Crea una carpeta data/ o snapshots/ para almacenar resultados.
Ejecuta el script dos veces â†’ deben generarse dos CSV distintos.
ğŸ’¡ Tarea: asegurarte de que el script crea la carpeta si no existe.
DÃ­a 5 â€“ RotaciÃ³n de ficheros
ğŸ¯ Objetivo: evitar acumulaciÃ³n de snapshots antiguos.
Implementa una lÃ³gica para mantener solo los N mÃ¡s recientes (p. ej. 10).
Usa ls -t | tail -n +11 | xargs rm como base conceptual (no la copies literal aÃºn).
Prueba que elimina correctamente los viejos sin afectar a los nuevos.
ğŸ’¡ Tarea: deja un comentario explicando cÃ³mo funciona la rotaciÃ³n.
ğŸ“… Semana 2 â€” AnÃ¡lisis, alertas y automatizaciÃ³n
DÃ­a 6 â€“ Conteo por IP
ğŸ¯ Objetivo: analizar la Ãºltima captura.
Usa awk o cut para extraer la columna de IP origen.
Haz un conteo de frecuencia (sort | uniq -c | sort -nr).
Guarda el resultado en un fichero temporal o imprime en pantalla.
ğŸ’¡ Tarea: documenta cuÃ¡l serÃ¡ el umbral de alerta (p. ej. 50 conexiones).
DÃ­a 7 â€“ Registro de alertas
ğŸ¯ Objetivo: crear alerts.log.
Si alguna IP supera el umbral, escribe una lÃ­nea con:
timestamp
IP sospechosa
nÃºmero de conexiones
Usa formato CSV o texto plano.
ğŸ’¡ Tip: usa date para timestamp y >> para aÃ±adir al log.
DÃ­a 8 â€“ IntegraciÃ³n con cron
ğŸ¯ Objetivo: ejecutar automÃ¡ticamente el monitor.
Abre el crontab (crontab -e) y programa ejecuciÃ³n cada 5 min.
Usa rutas absolutas para todo.
Verifica que los nuevos CSV aparecen automÃ¡ticamente.
ğŸ’¡ Tarea: aÃ±adir prueba manual + verificaciÃ³n del cron.log (opcional).
DÃ­a 9 â€“ Validaciones y limpieza
ğŸ¯ Objetivo: asegurar fiabilidad.
Simula actividad real (abrir mÃºltiples conexiones, SSH, etc.).
Verifica que las alertas se disparan correctamente.
Comprueba permisos, rutas y logs.
ğŸ’¡ Tarea: aÃ±ade control de errores (si ss falla, mostrar mensaje y salir).
DÃ­a 10 â€“ DocumentaciÃ³n final
ğŸ¯ Objetivo: empaquetar el proyecto.
Crea un README.md con:
descripciÃ³n del script
requisitos
uso manual y automÃ¡tico
explicaciÃ³n de columnas CSV
ejemplo de salida
Opcional: aÃ±ade una licencia MIT o similar.
ğŸ’¡ Tarea: haz commit en GitHub y marca la versiÃ³n como v1.0.
ğŸš€ Resultado final
Al terminar tendrÃ¡s un sistema que:
Monitoriza conexiones activas de red.
Registra snapshots periÃ³dicos con rotaciÃ³n.
Detecta IPs sospechosas por nÃºmero de conexiones.
Se ejecuta automÃ¡ticamente con cron.
EstÃ¡ documentado profesionalmente.
